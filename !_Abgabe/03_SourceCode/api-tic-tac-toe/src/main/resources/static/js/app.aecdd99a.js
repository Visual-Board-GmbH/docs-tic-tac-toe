(function(e){function t(t){for(var r,i,o=t[0],l=t[1],u=t[2],m=0,d=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},s=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},1:function(e,t){},"13fd":function(e,t,a){},1855:function(e,t,a){},2:function(e,t){},3:function(e,t){},"33c3":function(e,t,a){"use strict";var r=a("ce8e"),n=a.n(r);n.a},3415:function(e,t,a){},4:function(e,t){},4884:function(e,t,a){},"51be":function(e,t,a){"use strict";(function(e){a("99af"),a("4de4"),a("7db0"),a("c740"),a("4160"),a("c975"),a("a434"),a("d3b7"),a("25f0"),a("159b");var r,n,s=a("ade3"),i=a("53ca"),o=a("c2e4"),l=a("f28c"),u=a("84e8"),c=a("a026"),m={activeGames:[],allGames:[],closedGames:[],playerImage:{}},d={activeGames:function(e){return e.activeGames},myGames:function(e,t){return e.activeGames.filter((function(e){return e.gameData.host===t.authenticatedUser.id||e.gameData.guest===t.authenticatedUser.id}))},openGames:function(e,t){return e.activeGames.filter((function(e){return"OPEN"===e.state&&!(e.gameData.host===t.authenticatedUser.id||e.gameData.guest===t.authenticatedUser.id)}))},allGames:function(e){return e.allGames=e.activeGames.concat(e.closedGames),e.allGames},closedGames:function(e){return e.closedGames},myClosedGames:function(e,t){return e.closedGames.filter((function(e){return e.gameData.host===t.authenticatedUser.id||e.gameData.guest===t.authenticatedUser.id}))},getPlayerImages:function(e){return e.playerImage}},f=(r={},Object(s["a"])(r,o["e"],(function(e,t){var a=e.rootGetters,r=Math.round(1e3*(Math.random()+1)),n={gameId:"",name:t,state:"OPEN",lastModified:new Date,matrixIds:[],gameData:{host:a.authenticatedUser.id,guest:0,moves:[],winner:null},playerData:[],statusCode:0,requestId:r,serverResponse:!1};l["a"].publish("ttt/new_game",JSON.stringify(n))})),Object(s["a"])(r,o["c"],(function(e,t){var a=e.commit,r=e.getters,n=r.activeGames,s=[];Array.isArray(t)&&t.length>0&&Array.isArray(n)&&t.forEach((function(e){var t=n.findIndex((function(t){return null!=t&&t.gameId===e.gameId}));if(-1!==t){var r=n[t];for(var l in e)if(r.hasOwnProperty(l)&&"statusCode"!==l&&"requestId"!==l&&"serverResponse"!==l&&("object"!==Object(i["a"])(r[l])&&e[l]!==r[l]||"object"===Object(i["a"])(r[l])&&JSON.stringify(e[l])!==JSON.stringify(r[l]))){a(o["h"],{game:e,storedGameIndex:t});break}s.push(r.gameId)}else s.push(e.gameId),a(o["a"],e)})),n.forEach((function(e,t){-1===s.indexOf(e.gameId)&&a(o["f"],t)}))})),Object(s["a"])(r,o["d"],(function(e,t){var a=e.commit,r=e.getters,n=r.closedGames;t.forEach((function(e){n.find((function(t){return null!=t&&t.id===e.id}))||a(o["b"],e)}))})),Object(s["a"])(r,o["g"],(function(t,a){var r=t.commit;a.forEach((function(t){Object(u["a"])({url:"/v1/player/"+t+"/image",method:"GET",responseType:"arraybuffer"}).then((function(a){var n=new e(a.data,"binary").toString("base64");""!=n&&r(o["g"],{image:n,userId:t})})).catch((function(e){console.log(e)}))}))})),r),p=(n={},Object(s["a"])(n,o["a"],(function(e,t){e.activeGames.push(t)})),Object(s["a"])(n,o["h"],(function(e,t){var a=t.game,r=t.storedGameIndex;e.activeGames.splice(r,1),e.activeGames.push(a)})),Object(s["a"])(n,o["f"],(function(e,t){e.activeGames.splice(t,1)})),Object(s["a"])(n,o["b"],(function(e,t){e.closedGames.push(t)})),Object(s["a"])(n,o["g"],(function(e,t){var a=t.image,r=t.userId;c["default"].set(e.playerImage,r,"data:image/png;base64,"+a)})),n);t["a"]={state:m,getters:d,actions:f,mutations:p}}).call(this,a("b639").Buffer)},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("0cdd");var r=a("a026"),n=a("5f5b");a("ab8b"),a("2dd8");r["default"].use(n["b"]);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"p-5",attrs:{fluid:""}},[this.$store.getters.isAuthenticated?a("Navbar"):e._e(),a("router-view")],1)},i=[],o=a("b1e0"),l=(a("15f5"),a("7051"),a("f9e3"),a("4a7a")),u=a.n(l),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"d-flex justify-content-center"},[a("b-navbar",{attrs:{toggleable:"lg"}},[a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":"",align:"center"}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/play"}},[a("i",{staticClass:"fas fa-play fa-3x"})]),a("b-nav-item",{attrs:{to:"/history"}},[a("i",{staticClass:"fas fa-history fa-3x"})]),a("b-nav-item",{attrs:{to:"/user"}},[a("b-row",[a("b-col",[a("i",{staticClass:"fas fa-user fa-3x"})])],1),a("b-row",[a("b-col",[a("span",{staticClass:"mr-2 userName"},[e._v(e._s(this.$store.getters.authenticatedUser.nickname))])])],1)],1),a("b-nav-item",{attrs:{to:"/logout"}},[a("i",{staticClass:"fas fa-sign-out-alt fa-3x"})])],1)],1)],1)],1)},m=[],d="AUTH_REQUEST",f="AUTH_SUCCESS",p="AUTH_ERROR",g="AUTH_LOGOUT",h="AUTH_CHECK",b="SET_AUTHENTICATED_USER",v={name:"Navbar",methods:{logout:function(){var e=this;this.$store.dispatch(g).then((function(){e.$router.push("/login")}))}}},y=v,_=(a("db26"),a("2877")),w=Object(_["a"])(y,c,m,!1,null,"07288b0f",null),S=w.exports;a("6dfc");r["default"].use(n["a"]),r["default"].use(o["a"]),r["default"].component("v-select",u.a);var O,I,D={name:"App",components:{Navbar:S}},G=D,T=(a("034f"),Object(_["a"])(G,s,i,!1,null,null,null)),$=T.exports,E=a("2f62"),x=(a("d3b7"),a("ade3")),M=a("84e8"),k={authenticatedUser:null,status:""},U={isAuthenticated:function(e){return null!=e.authenticatedUser},authStatus:function(e){return e.status},authenticatedUser:function(e){return e.authenticatedUser}},C=(O={},Object(x["a"])(O,d,(function(e,t){var a=e.commit;e.dispatch;return new Promise((function(e,r){a(d),Object(M["a"])({url:"/v1/player/authenticate",method:"POST",data:t,headers:{"Content-Type":"application/json"}}).then((function(t){a(f),a(b,t),e(t)})).catch((function(e){a(p,e),r(e)}))}))})),Object(x["a"])(O,g,(function(e){var t=e.commit;return new Promise((function(e){Object(M["a"])({url:"/v1/player/authenticate",method:"DELETE",headers:{"Content-Type":"application/json"}}),t(g),e()}))})),Object(x["a"])(O,h,(function(e){var t=e.commit,a=e.getters;return new Promise((function(e,r){Object(M["a"])({url:"/v1/player/authenticate/status",method:"POST",headers:{"Content-Type":"application/json"}}).then((function(r){t(f),""!=r.data&&null!=r.data&&(null===a.authenticatedUser||null!=a.authenticatedUser&&a.authenticatedUser.hasOwnProperty("id")&&a.authenticatedUser.id!==r.data.id)&&t(b,r),e(r)})).catch((function(e){t(p),r(e)}))}))})),O),N=(I={},Object(x["a"])(I,d,(function(e){e.status="loading",e.loadedOnce=!0,e.hasLoadedOnce=!0})),Object(x["a"])(I,f,(function(e){e.status="success"})),Object(x["a"])(I,b,(function(e,t){e.authenticatedUser=t.data})),Object(x["a"])(I,p,(function(e){e.status="error",e.authenticatedUser=null})),Object(x["a"])(I,g,(function(e){e.authenticatedUser=null,e.status=""})),I),j={state:k,getters:U,actions:C,mutations:N},P=a("51be");r["default"].use(E["a"]);var A=!1,H=new E["a"].Store({modules:{auth:j,game:P["a"]},strict:A}),L=a("f28c"),q=(a("45fc"),a("96cf"),a("1da1")),R=a("8c4f"),B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"shadow p-3 mb-5 mt-5 bg-white rounded"},[a("h3",[e._v("Login")]),a("b-form",{attrs:{validated:"true"},on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[a("b-form-group",{attrs:{id:"input-group-1",label:"Benutzername:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-1",type:"text",required:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("b-form-group",{attrs:{id:"input-group-2",label:"Passwort:","label-for":"input-2","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-2",required:"",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("b-button",{attrs:{block:"",type:"submit",variant:"primary"}},[e._v("Anmelden")]),a("small",[e._v("Besitzen Sie noch keinen Account. Erstellen Sie einen "),a("router-link",{attrs:{to:{name:"Register"}}},[e._v("hier")])],1)],1)],1)},V=[],J={name:"LoginVue",components:{},data:function(){return{form:{username:"",password:""},show:!0}},methods:{login:function(){var e=this;this.$store.dispatch(d,this.form).then((function(){e.$router.push("/play")})).catch((function(){e.$bvToast.toast("Ups! Da ist etwas schiefgelaufen. Bitte versuchen Sie es nochmals.",{title:"Login Fehlgeschlagen.",variant:"danger",solid:!0,appendToast:!0})}))}}},z=J,F=Object(_["a"])(z,B,V,!1,null,"9b9fdd2a",null),W=F.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"shadow p-3 mb-5 mt-5 bg-white rounded"},[a("h3",[e._v("Registration")]),e.show?a("b-form",{attrs:{validated:"true"},on:{submit:e.onSubmit,reset:e.onReset}},[a("b-form-group",{attrs:{id:"input-group-1",label:"Name:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-1",type:"text",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("b-form-group",{attrs:{id:"input-group-2",label:"Benutzername:","label-for":"input-2","label-align":"left",description:"Name für das Benutzerlogin"}},[a("b-form-input",{attrs:{id:"input-2",required:"",type:"text"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("b-form-group",{attrs:{id:"input-group-3",label:"Nickname:","label-for":"input-3","label-align":"left",description:"Spielername, wird anderen Spielern angezeigt"}},[a("b-form-input",{attrs:{id:"input-3",required:"",type:"text"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("b-form-group",{attrs:{id:"input-group-4",label:"Passwort:","label-for":"input-4","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-4",required:"",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("b-button",{attrs:{block:"",type:"submit",variant:"primary"}},[e._v("Registrieren")]),a("small",[e._v("Bereits registriert? "),a("router-link",{attrs:{to:{name:"Login"}}},[e._v("Anmelden")])],1)],1):e._e()],1)},Q=[],K=(a("b0c0"),{name:"RegisterView",components:{},data:function(){return{form:{name:"",username:"",nickname:"",password:""},show:!0}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),Object(M["a"])({method:"post",url:"/v1/player",data:this.form,headers:{"Content-Type":"application/json"}}).then((function(){ht.push("/login")})).catch((function(e){console.log("Registration failed with the following error: "+e),t.$bvToast.toast("Ups! Da ist etwas schiefgelaufen. Bitte versuchen Sie es nochmals.",{title:"Registration Fehlgeschlagen.",variant:"danger",solid:!0,appendToast:!0})}))},onReset:function(e){var t=this;e.preventDefault(),this.form.email="",this.form.name="",this.form.food=null,this.form.checked=[],this.show=!1,this.$nextTick((function(){t.show=!0}))}}}),Y=K,X=(a("8286"),Object(_["a"])(Y,Z,Q,!1,null,"a66a8d3c",null)),ee=X.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-new-game",modifiers:{"modal-new-game":!0}}],staticClass:"btn"},[a("i",{staticClass:"fas fa-plus"}),a("span",{staticClass:"ml-2"},[e._v("Neues Spiel")])]),a("b-modal",{attrs:{id:"modal-new-game",title:"Neues Spiel","hide-footer":""}},[a("b-form",{on:{submit:function(t){return t.preventDefault(),e.newGame(t)}}},[a("b-form-group",{attrs:{id:"input-group-1",label:"Spielname:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-1",type:"text",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("b-button",{attrs:{block:"",type:"submit",variant:"primary"}},[e._v("Erstellen")])],1)],1),a("h3",[e._v("Meine Spiele")]),a("GameList",{attrs:{games:e.myGames,items:e.myGameItems}}),a("h3",[e._v("Offene Spiele")]),a("GameList",{attrs:{games:e.openGames,items:e.openGameItems}})],1)},ae=[],re=(a("7db0"),a("d81d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-table",{attrs:{items:this.items||e.games.items,fields:e.games.fields,"show-empty":"","empty-text":"Keine Spiele vorhanden","sticky-header":"",hover:!0},on:{"row-clicked":e.openGame}})}),ne=[],se=a("c2e4"),ie={name:"GameList",props:["games","items"],methods:{openGame:function(e){this.$store.dispatch(se["g"],[e.gameData.host,e.gameData.guest]).then((function(){ht.push({name:"Game",params:{id:e.gameId||e.id}})}))}}},oe=ie,le=Object(_["a"])(oe,re,ne,!1,null,"b2856d84",null),ue=le.exports,ce={name:"PlayView",data:function(){return{form:{name:""},myGames:{fields:[{key:"gameId",class:"d-none"},{key:"name",sortable:!0},{label:"Status",key:"state",sortable:!0,formatter:function(e){switch(e){case"OPEN":return"Warte auf Spieler";case"PENDING":return"Warte auf Spielstart";case"ACTIVE":return"Spiel gestartet";default:return e}}},{label:"Gastgeber",key:"gameData.host",formatter:function(e,t,a){return a.playerData.find((function(e){return"HOST"===e.player})).displayName}},{label:"Gast",key:"gameData.guest",formatter:function(e,t,a){return a.playerData.find((function(e){return"GUEST"===e.player}))?a.playerData.find((function(e){return"GUEST"===e.player})).displayName:"Warte auf Spieler"}},{label:"Zuletzt geändert",key:"lastModified",formatter:function(e){var t=new Date(parseInt(e,10)),a={weekday:"long",year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("de-DE",a)},sortable:!0},{key:"playerData",class:"d-none"}],items:[]},openGames:{fields:[{key:"gameId",class:"d-none"},{key:"name",sortable:!0},{label:"Status",key:"state",sortable:!0,formatter:function(e){switch(e){case"OPEN":return"Warte auf Spieler";case"PENDING":return"Warte auf Spielstart";case"ACTIVE":return"Spiel gestartet";default:return e}}},{label:"Gastgeber",key:"gameData.host",formatter:function(e,t,a){return a.playerData.find((function(e){return"HOST"===e.player})).displayName}},{label:"Gast",key:"gameData.guest",formatter:function(e,t,a){return a.playerData.find((function(e){return"GUEST"===e.player}))?a.playerData.find((function(e){return"GUEST"===e.player})).displayName:"Warte auf Spieler"}},{label:"Zuletzt geändert",key:"lastModified",formatter:function(e){var t=new Date(parseInt(e,10)),a={weekday:"long",year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("de-CH",a)},sortable:!0},{key:"playerData",class:"d-none"}],items:[]}}},computed:{myGameItems:function(){return this.$store.getters.myGames.map((function(e){var t=e.gameData.moves;return t.length>0&&"HOST"===t[t.length-1].player?e._cellVariants={"gameData.guest":"success"}:t.length>0&&"GUEST"===t[t.length-1].player&&(e._cellVariants={"gameData.host":"success"}),e}))},openGameItems:function(){return this.$store.getters.openGames}},created:function(){var e=this;this.$mqtt.on("message",(function(t,a){if("ttt/new_game"===t){var r=JSON.parse(a);1==r.serverResponse&&200===r.statusCode&&console.log("message: "+r)}if("ttt/all_games"===t){var n=JSON.parse(a);e.$store.dispatch(se["c"],n)}}))},components:{GameList:ue},methods:{newGame:function(){this.$store.dispatch(se["e"],this.form.name),this.$root.$emit("bv::hide::modal","modal-new-game")}}},me=ce,de=(a("65e5"),Object(_["a"])(me,te,ae,!1,null,"ad9b51d8",null)),fe=de.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"shadow p-3 mb-5 mt-5 bg-white rounded"},[e.dataLoaded?a("b-tabs",{attrs:{user_profile:""}},[a("b-tab",{attrs:{title:"Benutzerinformation"}},[a("b-form",{staticClass:"mt-3",on:{submit:function(t){return t.preventDefault(),e.updateUser(t)}}},[a("b-form-group",{attrs:{id:"input-group-1",label:"Name:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-1",type:"text",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("b-form-group",{attrs:{id:"input-group-2",label:"Benutzername:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-2",type:"text",required:""},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),a("b-form-group",{attrs:{id:"input-group-3",label:"Nickname:","label-for":"input-1","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-3",type:"text",required:""},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("b-form-group",{attrs:{id:"input-group-4",label:"Passwort:","label-for":"input-2","label-align":"left"}},[a("b-form-input",{attrs:{id:"input-4",required:"",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("b-button",{attrs:{block:"",type:"submit",variant:"primary"}},[e._v("Speichern")])],1)],1),a("b-tab",{attrs:{title:"Spielzeichen"}},[a("b-row",{staticClass:"mt-3"},[a("b-col",[a("b-form-group",{attrs:{id:"input-group-6",label:"Spiel-Zeichen:","label-for":"input-6","label-align":"left"}},[a("b-file",{attrs:{id:"input-6",placeholder:"Datei hinzufüpgen um Zeichen anzupassen","drop-placeholder":"Ziehen Sie eine Datei hier hin."},on:{change:e.onTileImageChange},model:{value:e.form.tileImage,callback:function(t){e.$set(e.form,"tileImage",t)},expression:"form.tileImage"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{id:"input-group-7",label:"Aktuelles-Zeichen:","label-for":"input-7","label-align":"left"}},[e.tileImageSrc?a("img",{staticClass:"mt-2",attrs:{id:"input-7",src:e.tileImageSrc}}):e._e()])],1)],1)],1)],1):e._e()],1)},ge=[],he={name:"UserView",data:function(){return{dataLoaded:!1,form:{name:"",userName:"",nickname:"",password:"",tileImage:null}}},methods:{updateUser:function(){var e={name:this.form.name,username:this.form.userName,nickname:this.form.nickname,password:this.form.password},t=this.$store.getters.authenticatedUser;Object(M["a"])({url:"/v1/player/"+t.id,data:e,method:"PUT",headers:{"Content-Type":"application/json"}}).catch((function(e){console.log(e)}))},onTileImageChange:function(e){var t=this,a=e.target.files[0],r=new FormData;r.append("image",a),Object(M["a"])({url:"/v1/player/"+this.$store.getters.authenticatedUser.id+"/image",data:r,method:"POST",headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.$store.dispatch(se["g"],[t.$store.getters.authenticatedUser.id]),console.log(e)})).catch((function(e){console.log(e)}))}},created:function(){this.$store.dispatch(se["g"],[this.$store.getters.authenticatedUser.id]);var e=this.$store.getters.authenticatedUser;this.form.name=e.name,this.form.userName=e.username,this.form.nickname=e.nickname,this.dataLoaded=!0},computed:{tileImageSrc:function(){return this.$store.getters.getPlayerImages[this.$store.getters.authenticatedUser.id]}},components:{}},be=he,ve=Object(_["a"])(be,pe,ge,!1,null,"ec1e016c",null),ye=ve.exports,_e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("h3",[e._v("Vergangene Spiele")]),a("GameList",{attrs:{games:e.gameHistory,items:e.myClosedGame}})],1)},we=[],Se={name:"HistoryView",data:function(){return{gameHistory:{fields:[{key:"gameId",class:"d-none"},{key:"name",sortable:!0},{label:"Gastgeber",key:"gameData.host",formatter:function(e,t,a){return a.playerData.find((function(e){return"HOST"===e.player})).displayName}},{label:"Gast",key:"gameData.guest",formatter:function(e,t,a){return a.playerData.find((function(e){return"GUEST"===e.player}))?a.playerData.find((function(e){return"GUEST"===e.player})).displayName:"Warte auf Spieler"}},{label:"Spieldatum",key:"datePlayed",formatter:function(e){var t=new Date(parseInt(e,10)),a={weekday:"long",year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("de-CH",a)},sortable:!0},{key:"playerData",class:"d-none"}],items:[]}}},created:function(){var e=this;this.$mqtt.on("message",(function(t,a){if("ttt/all_game_histories"===t){var r=JSON.parse(a);e.$store.dispatch(se["d"],r)}}))},computed:{myClosedGame:function(){var e=this;return this.$store.getters.myClosedGames.map((function(t){var a=t.gameData.winner;if("NONE"!==a){var r="HOST"===a?t.gameData.host:t.gameData.guest;r===e.$store.getters.authenticatedUser.id?t._rowVariant="success":t._rowVariant="danger"}else t._rowVariant="warning";return t}))}},components:{GameList:ue}},Oe=Se,Ie=Object(_["a"])(Oe,_e,we,!1,null,"3309dc1a",null),De=Ie.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{attrs:{fluid:""}},[this.game?a("b-row",{staticClass:"mt-3"},[a("b-col",[a("b-row",[a("b-col",{attrs:{cols:"5"}},[a("router-link",{staticClass:"btn",attrs:{tag:"button",to:"\\play"},nativeOn:{click:function(t){return e.goBack()}}},[a("i",{staticClass:"fas fa-arrow-left"})])],1),a("b-col",{attrs:{cols:"7"}},[a("PlayerBoard",{attrs:{host:e.game.gameData.host,guest:e.game.gameData.guest,activePlayer:e.playerOnTheMove,winner:e.game.gameData.winner,playerData:e.game.playerData}})],1)],1),a("b-row",{staticClass:"mt-5"},[a("b-col",{staticClass:"mb-2",attrs:{xs:"12",sm:"5"}},[a("b-row",[a("b-col",{attrs:{lg:"12",xl:"6"}},[e.isHost&&e.matrixIds.length>0?a("v-select",{attrs:{placeholder:"Bitte wählen Sie eine Matrix",options:e.matrixIds,multiple:"",reduce:function(e){return e.value}},on:{input:e.sendMatrixIds,created:e.getMatrixIds},model:{value:e.selectedMatrixIds,callback:function(t){e.selectedMatrixIds=t},expression:"selectedMatrixIds"}}):e._e()],1),a("b-col",{attrs:{cols:"auto"}},[a("h3",[e._v(e._s(this.game.name))])])],1),a("b-row",[e.game.gameData.moves.length>0?a("GameHistory",{attrs:{moves:e.game.gameData.moves,playerData:e.game.playerData,isHistory:e.isHistory,selectedMove:e.selectedMove},on:{goBackInHistory:e.revertMove}}):e._e()],1)],1),a("b-col",{attrs:{xs:"12",sm:"7"}},[a("GameBoard",{attrs:{moves:e.tempMoves,host:e.game.gameData.host,hostImg:e.hostImg,guest:e.game.gameData.guest,guestImg:e.guestImg,isHistory:e.isHistory,serverError:e.isServerError,playerOnTheMove:e.playerOnTheMove,waitingForPlayer:e.waitingForPlayer,winner:e.game.gameData.winner},on:{updateGame:e.updateGame}})],1)],1)],1)],1):e._e(),this.game?e._e():a("b-row",[e._v(" Kein Spiel gefunden ")])],1)},Te=[],$e=(a("4160"),a("25f0"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",[a("GameBoardGrid",{attrs:{moves:e.moves,grid:e.gridLayout,isReadOnly:e.isHistory||!0!==e.isPlayerOnTheMove||!0===e.waitingForPlayer||null!==e.winner||e.serverError},on:{updateGame:e.updateGame}})],1)}),Ee=[],xe=(a("c740"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"game-board-grid",class:{disabled:e.isReadOnly},attrs:{fluid:""}},[a("b-row",{attrs:{cols:"3"}},e._l(e.grid,(function(t){return a("GameBoardCell",{key:t.id,attrs:{colId:t.id,tile:t.tile,image:t.image,position:t.position,isSet:t.isSet},on:{setValueInCell:function(a){return e.updateCellValue(t.position)}}})})),1)],1)}),Me=[],ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-col",{staticClass:"game-board-cell align-items-center",class:{disabled:!0===e.isSet},on:{click:function(t){return e.setValue(e.colId)}}},[e.isSet&&null!==e.getImage?a("div",{staticClass:"game-board-cell-content"},[a("b-img",{staticClass:"p-2",attrs:{src:e.getImage,center:"","fluid-grow":"",alt:e.getTile}})],1):a("div",{staticClass:"game-board-cell-content text-center"},[a("span",{domProps:{innerHTML:e._s(e.getTile)}})])])},Ue=[],Ce={name:"GameBoardCell",props:["colId","isSet","position","tile","image","isActivePlayer"],methods:{setValue:function(e){this.$emit("setValueInCell",e)}},computed:{getImage:function(){return""!==this.image&&null!=this.image?this.image:null},getTile:function(){return"X"===this.tile?'<i class="fas fa-times"></i>':"O"===this.tile?'<i class="far fa-circle"></i>':""}}},Ne=Ce,je=(a("e600"),Object(_["a"])(Ne,ke,Ue,!1,null,"a3ee495c",null)),Pe=je.exports,Ae={name:"GameBoardGrid",props:["grid","isReadOnly"],methods:{updateCellValue:function(e){console.log(e),this.$emit("updateGame",e)}},components:{GameBoardCell:Pe}},He=Ae,Le=(a("5ab6"),Object(_["a"])(He,xe,Me,!1,null,"5578852c",null)),qe=Le.exports,Re={name:"GameBoard",props:["moves","host","guest","isHistory","playerOnTheMove","waitingForPlayer","winner","hostImg","guestImg","serverError"],methods:{updateGame:function(e){var t={count:this.moves.length+1,player:this.playerOnTheMove,gridPosition:e};this.$emit("updateGame",t)}},computed:{gridLayout:function(){for(var e,t=this,a=[{id:1,position:"TOP_LEFT",isSet:!1,tile:"",image:""},{id:2,position:"TOP_MID",isSet:!1,tile:"",image:""},{id:3,position:"TOP_RIGHT",isSet:!1,tile:"",image:""},{id:4,position:"MID_LEFT",isSet:!1,tile:"",image:""},{id:5,position:"MID_MID",isSet:!1,tile:"",image:""},{id:6,position:"MID_RIGHT",isSet:!1,tile:"",image:""},{id:7,position:"BOTTOM_LEFT",isSet:!1,tile:"",image:""},{id:8,position:"BOTTOM_MID",isSet:!1,tile:"",image:""},{id:9,position:"BOTTOM_RIGHT",isSet:!1,tile:"",image:""}],r=this.moves,n=function(n,s){e=a.findIndex((function(e){return e.position===r[n].gridPosition})),a[e].isSet=!0,a[e].tile="HOST"===r[n].player?"X":"O",a[e].image="HOST"===r[n].player?t.hostImg:t.guestImg},s=0,i=r.length;s<i;s++)n(s,i);return a},isPlayerOnTheMove:function(){var e=this.moves,t=this.host,a=this.$store.getters.authenticatedUser?this.$store.getters.authenticatedUser:{};return e.length>0&&"HOST"===e[e.length-1].player&&(t=this.guest),!(!a.hasOwnProperty("id")||a.id!==t)}},components:{GameBoardGrid:qe}},Be=Re,Ve=Object(_["a"])(Be,$e,Ee,!1,null,"40804d58",null),Je=Ve.exports,ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"shadow bg-white rounded"},[a("b-row",[a("b-col",[a("h5",[e._v("History")])])],1),e._l(this.moves,(function(t){return a("b-row",{key:t.count,class:{"bg-info":e.selectedMove==t.count},on:{click:function(a){return e.changeMove(t.count)}}},["HOST"===t.player?a("b-col",[e._v("Zug Nr. "+e._s(t.count)+" von Spieler "+e._s(e.playerData.find((function(e){return"HOST"===e.player})).displayName))]):"GUEST"===t.player?a("b-col",[e._v("Zug Nr. "+e._s(t.count)+" von Spieler "+e._s(e.playerData.find((function(e){return"GUEST"===e.player})).displayName))]):a("b-col",[e._v("Zug Nr. "+e._s(t.count)+" von Spieler "+e._s(t.player))]),a("b-col",{attrs:{cols:"3"}},[a("i",{staticClass:"fas fa-undo-alt ml-1"})])],1)}))],2)},Fe=[],We=(a("4de4"),{name:"GameHistory",props:["moves","selectedMove","playerData"],methods:{changeMove:function(e){var t=this.moves.filter((function(t){return t.count<=e}));this.$emit("goBackInHistory",t)}}}),Ze=We,Qe=Object(_["a"])(Ze,ze,Fe,!1,null,"5a5f08c4",null),Ke=Qe.exports,Ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"shadow bg-white rounded"},[a("b-row",[a("b-col",{staticClass:"p-2 rounded text-center",class:{active:"HOST"===e.activePlayer,"bg-success":"HOST"===e.winner,"bg-warning":"NONE"===e.winner}},[e._v(e._s(e.getDisplayName("HOST")))]),a("b-col",{staticClass:"p-2 rounded text-center",class:{active:"GUEST"===e.activePlayer,"bg-success":"GUEST"===e.winner,"bg-warning":"NONE"===e.winner}},[e._v(e._s(0===this.guest?"Warten auf Spieler":e.getDisplayName("GUEST")))])],1)],1)},Xe=[],et={name:"PlayerBoard",props:["host","guest","activePlayer","winner","playerData"],methods:{getDisplayName:function(e){return this.playerData.find((function(t){return t.player===e}))?this.playerData.find((function(t){return t.player===e})).displayName:e}}},tt=et,at=(a("33c3"),Object(_["a"])(tt,Ye,Xe,!1,null,"22deb14d",null)),rt=at.exports,nt={name:"GameView",components:{PlayerBoard:rt,GameHistory:Ke,GameBoard:Je},data:function(){var e=this;return{game:this.$store.getters.allGames.find((function(t){return(t.gameId===parseInt(e.$route.params.id,10)||t.id===parseInt(e.$route.params.id,10))&&(t.gameData.host===e.$store.getters.authenticatedUser.id||t.gameData.guest===e.$store.getters.authenticatedUser.id||e.$store.getters.authenticatedUser.id!==t.gameData.host&&0===t.gameData.guest)})),tempMoves:[],isHistory:!1,selectedMatrixIds:[],matrixIds:[]}},methods:{sendMatrixIds:function(){var e=this.game;e.gameData.moves=[],e.matrixIds=this.selectedMatrixIds,e.statusCode=0,e.serverResponse=!1,this.$mqtt.publish("ttt/game",JSON.stringify(e))},revertMove:function(e){this.tempMoves=e,this.isHistory=this.game.gameData.moves.length>this.tempMoves.length},updateGame:function(e){var t=this.game;1===this.selectedMove&&(t.state="ACTIVE"),t.matrixIds=this.selectedMatrixIds,t.gameData.moves.push(e),t.statusCode=0,t.serverResponse=!1,delete t._cellVariants,this.$mqtt.publish("ttt/game",JSON.stringify(t))},goBack:function(){ht.go(-1)},getMatrixIds:function(){var e=this;Object(M["a"])({url:"/v1/matrix",method:"GET"}).then((function(t){var a=[];t.data.forEach((function(e){e.available&&a.push({value:e.id,label:"Matrix "+e.id})})),e.matrixIds=a})).catch((function(e){console.log(e)}))}},created:function(){var e=this;if(this.getMatrixIds(),this.$mqtt.on("message",(function(t,a){if("ttt/game"===t){var r=JSON.parse(a.toString());1==r.serverResponse&&200===r.statusCode&&"PENDING"===r.state&&(e.game=r),1==r.serverResponse&&200===r.statusCode&&"ACTIVE"===r.state&&(e.game=r,e.tempMoves=r.gameData.moves),e.selectedMatrixIds=e.game.matrixIds}if(!e.game){if("ttt/all_games"===t){var n=JSON.parse(a);void 0===e.game&&(e.game=n.find((function(t){return t.gameId===parseInt(e.$route.params.id,10)&&(t.gameData.host===e.$store.getters.authenticatedUser.id||t.gameData.guest===e.$store.getters.authenticatedUser.id||e.$store.getters.authenticatedUser.id!==t.gameData.host&&0===t.gameData.guest)}))),e.$store.dispatch(se["c"],n)}if("ttt/all_game_histories"===t){var s=JSON.parse(a);void 0===e.game&&(e.game=s.find((function(t){return t.gameId===parseInt(e.$route.params.id,10)&&(t.gameData.host===e.$store.getters.authenticatedUser.id||t.gameData.guest===e.$store.getters.authenticatedUser.id||e.$store.getters.authenticatedUser.id!==t.gameData.host&&0===t.gameData.guest)}))),e.$store.dispatch(se["d"],s)}e.game&&(e.tempMoves=e.game.gameData.moves,e.selectedMatrixIds=e.game.matrixIds)}})),this.game&&(this.tempMoves=this.game.gameData.moves,this.selectedMatrixIds=this.game.matrixIds,this.waitingForPlayer&&this.$store.getters.authenticatedUser.id!==this.game.gameData.host)){var t=this.game;t.state="PENDING",t.gameData.guest=this.$store.getters.authenticatedUser.id,t.statusCode=0,t.serverResponse=!1,this.$mqtt.publish("ttt/game",JSON.stringify(t))}},computed:{playerOnTheMove:function(){var e=this.game.gameData.moves;return e.length>0&&"HOST"===e[e.length-1].player?"GUEST":"HOST"},isHost:function(){return this.game.gameData.host===this.$store.getters.authenticatedUser.id},waitingForPlayer:function(){return 0===this.game.gameData.guest&&"OPEN"===this.game.state},selectedMove:function(){return 0===this.tempMoves.length?1:this.tempMoves.length},hostImg:function(){return this.$store.getters.getPlayerImages[this.game.gameData.host]},guestImg:function(){return this.$store.getters.getPlayerImages[this.game.gameData.guest]},getGame:function(){var e=this;return this.$store.getters.allGames.find((function(t){return(t.gameId===parseInt(e.$route.params.id,10)||t.id===parseInt(e.$route.params.id,10))&&(t.gameData.host===e.$store.getters.authenticatedUser.id||t.gameData.guest===e.$store.getters.authenticatedUser.id||e.$store.getters.authenticatedUser.id!==t.gameData.host&&0===t.gameData.guest)}))},isServerError:function(){return 5e3===this.game.statusCode&!0===this.game.serverResponse}}},st=nt,it=Object(_["a"])(st,Ge,Te,!1,null,"7e6c9e20",null),ot=it.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("Logout Successfull!")])},ut=[],ct={name:"Logout",created:function(){var e=this;this.$store.dispatch(g).then((function(){e.$router.push("/login")}))}},mt=ct,dt=Object(_["a"])(mt,lt,ut,!1,null,"0cbd1c9a",null),ft=dt.exports;r["default"].use(R["a"]);var pt=[{path:"*",name:"App",redirect:"/play",meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:W,meta:{requiresAuth:!1}},{path:"/logout",name:"Logout",component:ft,meta:{requiresAuth:!0}},{path:"/register",name:"Register",component:ee,meta:{requiresAuth:!1}},{path:"/play",name:"Play",component:fe,meta:{requiresAuth:!0}},{path:"/history",name:"History",component:De,meta:{requiresAuth:!0}},{path:"/user",name:"User",component:ye,meta:{requiresAuth:!0}},{path:"/game/:id",name:"Game",component:ot,props:!0}],gt=new R["a"]({mode:"history",base:"/",routes:pt});gt.beforeEach(function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t,a,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,H.dispatch(h);case 2:t.matched.some((function(e){return e.meta.requiresAuth}))?H.getters.isAuthenticated?r():r({name:"Login"}):r();case 3:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}());var ht=gt;r["default"].config.productionTip=!1,r["default"].prototype.$mqtt=L["a"],new r["default"]({el:"#app",store:H,router:ht,mqtt:L["a"],template:"<App/>",components:{App:$}})},"5ab6":function(e,t,a){"use strict";var r=a("fd47"),n=a.n(r);n.a},"65e5":function(e,t,a){"use strict";var r=a("1855"),n=a.n(r);n.a},8286:function(e,t,a){"use strict";var r=a("4884"),n=a.n(r);n.a},"84e8":function(e,t,a){"use strict";var r=a("bc3a"),n=a.n(r),s=n.a.create({baseURL:"http://"+location.hostname+":8081",timeout:1e4,withCredentials:!0});t["a"]=s},"85ec":function(e,t,a){},c2e4:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"h",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return u})),a.d(t,"g",(function(){return c}));var r="NEW_GAME",n="ADD_GAME_TO_GAME_LIST",s="BUILD_ACTIVE_GAME_LIST",i="UPDATE_GAME_IN_GAME_LIST",o="REMOVE_GAME_IN_GAME_LIST",l="BUILD_GAME_HISTORY",u="ADD_GAME_TO_HISTORY",c="SET_PLAYER_IMAGE"},ce8e:function(e,t,a){},db26:function(e,t,a){"use strict";var r=a("13fd"),n=a.n(r);n.a},e600:function(e,t,a){"use strict";var r=a("3415"),n=a.n(r);n.a},f28c:function(e,t,a){"use strict";a("d3b7"),a("25f0");var r=a("e7fc"),n=a.n(r),s="mqttjs_"+Math.random().toString(16).substr(2,8),i=n.a.connect("mqtt://tic-tac-toe-mqtt.hidora.com",{port:11168,clientId:s,clean:!1,keepAlive:!0,timeoutSeconds:10});i.on("connect",(function(){i.subscribe("ttt/all_games",{qos:0},(function(e){e&&console.log("MQTT Subscribtion failed with error: "+e)})),i.subscribe("ttt/all_game_histories",{qos:0},(function(e){e&&console.log("MQTT Subscribtion failed with error: "+e)})),i.subscribe("ttt/new_game",{qos:2},(function(e){e&&console.log("MQTT Subscribtion failed with error: "+e)})),i.subscribe("ttt/game",{qos:2},(function(e){e&&console.log("MQTT Subscribtion failed with error: "+e)}))})),t["a"]=i},fd47:function(e,t,a){}});
//# sourceMappingURL=app.aecdd99a.js.map